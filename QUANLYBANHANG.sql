CREATE DATABASE QUANLYBANHANG
GO

CREATE TABLE CHATLIEU (
    MACL NVARCHAR(10) NOT NULL PRIMARY KEY,
    TENCL NVARCHAR(100)
)
INSERT CHATLIEU VALUES 
(N'TT',N'Thủy tinh'),
(N'PL',N'Pha lê'),
(N'GĐ',N'Gỗ đồng'),
(N'MI',N'MICA'),
(N'NH',N'Nhựa'),
(N'TR',N'Tre'),
(N'S',N'Sợi cacbon'),
(N'V',N'Vãi'),
(N'NLHC',N'Nguyên liệu hữu cơ'),
(N'G',N'Gốm'),
(N'Su',N'Sứ'),
(N'CS',N'Cao su'),
(N'I',N'Inox'),
(N'MN',N'Mã não'),
(N'D',N'Da'),
(N'CT',N'Cẩm thạch'),
(N'B',N'Bạc'),
(N'M',N'Mây'),
(N'VO',N'Vỏ ốc');

CREATE TABLE CHUCVU(
	MACV NVARCHAR(10) NOT NULL PRIMARY KEY,
	TENCV NVARCHAR(100)
)
INSERT CHUCVU (MACV,TENCV)
VALUES
(N'CV1',N'QUẢN LÝ'),
(N'CV2',N'NHÂN VIÊN BÁN HÀNG'),
(N'CV3',N'NHÂN VIÊN KHO'),
(N'CV4',N'QUẢN LÝ KHO');

CREATE TABLE NHANVIEN (
    MANV NVARCHAR(10) NOT NULL PRIMARY KEY,
    TENNV NVARCHAR(100),
	MACV NVARCHAR(10) NOT NULL,
    GIOITINH NVARCHAR(10),
    NGAYSINH DATETIME,
    DIACHI NVARCHAR(500),
    DANTOC NVARCHAR(100),
    DIENTHOAI NVARCHAR(15),
    EMAIL NVARCHAR(MAX),
    LUONG FLOAT,
	CONSTRAINT FK_CHUCVU_MACV
    FOREIGN KEY (MACV)
    REFERENCES CHUCVU (MACV)
)

INSERT NHANVIEN VALUES 
(N'NV01',N'Phạm Nguyệt Anh',N'CV2',N'Nữ','2002-11-05',N'Phường Thạnh Mỹ Lợi, Quận 2, Thành phố Hồ Chí Minh',N'Kinh',N'0967567876',N'NguyetAn1105h@gmail.com',5500000.0),
(N'NV02',N'Nguyễn Minh Huy',N'CV2',N'Nam','2001-12-23',N'26, Đường 57, Nguyễn Thị Lắng, Ấp Chợ, Tân Phú Trung, Củ Chi, Thành phố Hồ Chí Minh',N'Khơ-Me',N'0876231456',N'MinhHuy2302@gmail.com',6000000.0),
(N'NV03',N'Phạm Quang Dự',N'CV2',N'Nam','1999-01-01',N'Tân Thông Hội, Củ Chi, Thành phố Hồ Chí Minh',N'Hoa',N'0678987678',N'QuangDu0101@gmail.com',6500000.0),
(N'NV04',N'Nguyễn Khánh Duy',N'CV2',N'Nam','2003-06-08',N'83, Phan Anh, Bình Trị Đông, Bình Tân, Thành phố Hồ Chí Minh',N'Kinh',N'0818978258',N'KhanhDuy08062003@gmail.com',8000000.0),
(N'NV05',N'Phước Công Nguyên',N'CV2',N'Nam','2002-08-01',N'139/16, Đường Chiến Lược, Bình Trị Đông, Bình Tân, Thành phố Hồ Chí Minh',N'Kinh',N'0915200360',N'CongNguyen0108@gmail.com',7000000.0),
(N'NV06',N'Phạm Trương Gia Hân',N'CV2',N'Nữ','2000-09-13',N'265, Nguyễn Trãi, Phường Nguyễn Cư Trinh, Quận 1, Thành phố Hồ Chí Minh',N'Khơ-Me',N'0848046390',N'GiaHan1309@gmail.com',5500000.0),
(N'NV07',N'Nguyễn Bảo Ngân',N'CV4',N'Nữ','2000-10-13',N'205, Nguyễn Cư Trinh, Phường Nguyễn Cư Trinh, Quận 3, Thành phố Hồ Chí Minh',N'Tày',N'0848046245',N'BaoNgan1310@gmail.com',15000000.0),
(N'NV08',N'Trần Văn Công',N'CV1',N'Nam','2002-09-13',N'101, Lạc Long Quân, Phường Lạc Long Quân, Quận 11, Thành phố Hồ Chí Minh',N'Kinh',N'0848124512',N'VanCong1309@gmail.com',15000000.0),
(N'NV09',N'Đoàn Văn Tú',N'CV3',N'Nam','1999-10-10',N'99, Nguyễn Thị Minh Khai, Phường Nguyễn Thiện Thuật, Quận 3, Thành phố Hồ Chí Minh',N'Kinh',N'08480465484',N'VanTu1010@gmail.com',6500000.0),
(N'NV10',N'Phan Thị Diễm',N'CV3',N'Nữ','2002-01-28',N'25, Lý Thái Tổ, Phường Bàn Cờ, Quận 10, Thành phố Hồ Chí Minh',N'Khơ-Me',N'08480464564',N'ThiDiem0128@gmail.com',6000000.0);

CREATE TABLE TAIKHOANNV (
    MATK_NV NVARCHAR(10) NOT NULL PRIMARY KEY,
    MANV NVARCHAR(10) NOT NULL,
    TENTK NVARCHAR(100),
    MATKH NVARCHAR(100), --MẬT KHẨU
    CONSTRAINT FK_TAIKHOANNV_MANV
    FOREIGN KEY (MANV)
    REFERENCES NHANVIEN (MANV)
)
INSERT TAIKHOANNV VALUES 
(N'MATK_NV01',N'NV01',N'NGUYETANH123',N'NGUYETANH123'),
(N'MATK_NV02',N'NV02',N'HUYR',N'HUYR'),
(N'MATK_NV03',N'NV03',N'QUANGQUANGDU',N'QUANGQUANGDU'),
(N'MATK_NV04',N'NV04',N'DUYDUY',N'DUYDUY'),
(N'MATK_NV05',N'NV05',N'PHUOCCONGNGUYEN',N'PHUOCCONGNGUYEN'),
(N'MATK_NV06',N'NV06',N'GIAHAN',N'GIAHAN'),
(N'MATK_NV07',N'NV07',N'BAONGAN',N'BAONGAN'),
(N'MATK_NV08',N'NV08',N'VANCONG',N'VANCONG'),
(N'MATK_NV09',N'NV09',N'VANTU',N'VANTU'),
(N'MATK_NV10',N'NV10',N'THIDIEM',N'THIDIEM');

CREATE TABLE KHACHHANG (
    MAKH NVARCHAR(10) NOT NULL PRIMARY KEY,
    TENKH NVARCHAR(100),
    GIOITINH NVARCHAR(10),
    NGAYSINH DATETIME,
    DIACHI NVARCHAR(500),
    MIEN NVARCHAR(100),
    DIENTHOAI NVARCHAR(15),
    EMAIL NVARCHAR(MAX)
)
INSERT KHACHHANG VALUES
(N'KH01',N'Trần Thái Nguyên',N'Nam',N'2002-06-11',N'266 Tô Hiến Thành, Phường 15, Quận 10, Thành phố Hồ Chí Minh',N'NAM',N'0945373250',N'thainguyen1106@gmail.com'),
(N'KH02',N'Đoàn Văn Đức',N'Nam',N'2001-05-01',N'51 Thành Thái, Phường 16, Quận 10, Thành phố Hồ Chí Minh',N'NAM',N'0349633678',N'vanduc0105@gmail.com'),
(N'KH03',N'Nguyễn Văn Toàn',N'Nam',N'2002-08-12',N'21 Nguyễn Thị Thực, Phường 2, Quận 3',N'NAM',N'0909365872',N'vantoan1208@gmail.com'),
(N'KH04',N'Trần Tấn Trung',N'Nam',N'2002-03-22',N'25/3C xã Bà Điểm, huyện Hóc Môn, Thành phố Hồ Chí Minh',N'NAM',N'0789654342',N'tantrung2203@gmail.com'),
(N'KH05',N'Denni Trần',N'Nam',N'2003-02-10',N'20/5A xã Nghĩa Lạc, huyện Nghĩa Hưng,tỉnh Nam Định',N'BAC',N'0987675657',N'Dennitran1002@gmail.com'),
(N'KH06',N'Ngô Thảo Ngân',N'Nữ',N'2004-05-07',N'92/4, Vườn Lài, An Phú Đông, Thành phố Hồ Chí Minh',N'NAM',N'0973337043',N'thaongan0705@gmail.com'),
(N'KH07',N'Trương Duy Khanh',N'Nam',N'2002-09-03',N'Đường Nguyễn Văn Linh, Phường An Khánh, Quận Ninh Kiều, Cần Thơ',N'NAM',N'0364494988',N'duykhanh0309@gmail.com'),
(N'KH08',N'Lê Thị Thanh Chúc',N'Nữ',N'2002-05-10',N'30 Lê Quý Đôn, phường Võ Thị Sáu, Quận 3, Thành phố Hồ Chí Minh',N'NAM',N'0969780427',N'thanhchuc1005@gmail.com'),
(N'KH09',N'Trần Bảo Linh',N'Nữ',N'1999-05-10',N'Nguyễn Thị Tần, Phường 2, Quận 8, Thành phố Hồ Chí Minh',N'NAM',N'0852333503',N'baolinh1005@gmail.com'),
(N'KH10',N'Trần Công Minh',N'Nam',N'1997-10-10',N'Dương Bá Tràng, Phường 1 Quận 8, Thành phố Hồ Chí Minh',N'NAM',N'0852303921',N'congminh1010@gmail.com'),
(N'KH11',N'Nguyễn Thị Huyền Trâm',N'Nữ',N'1999-09-01',N'Võ Văn Kiệt, Phường 1, Quận 5, Thành phố Hồ Chí Minh',N'NAM',N'0919900102',N'nguyenthihuyentram0109@gmail.com'),
(N'KH12',N'Dương Phương Quỳnh',N'Nữ',N'2004-08-25',N'196/5, Xóm Chiếu, Phường 14, Quận 4, Thành phố Hồ Chí Minh',N'NAM',N'0858223584',N'phuongquynh2508@gmail.com')

CREATE TABLE TAIKHOANKH ( --TÀI KHOẢN KHÁCH HÀNG
    MATK_KH NVARCHAR(10) NOT NULL PRIMARY KEY,
    MAKH NVARCHAR(10) NOT NULL,
    TENTK NVARCHAR(100),
    MATKH NVARCHAR(100), --MẬT KHẨU
    CONSTRAINT FK_TAIKHOANKH_MAKH
    FOREIGN KEY (MAKH)
    REFERENCES KHACHHANG (MAKH)
)
INSERT TAIKHOANKH VALUES
(N'MATK_KH01',N'KH01',N'THAINGUYEN1106',N'THAINGUYEN1106'),
(N'MATK_KH02',N'KH02',N'VANDUC21',N'VANDUC21'),
(N'MATK_KH03',N'KH03',N'VANTOAN1208',N'VANTOAN1208'),
(N'MATK_KH04',N'KH04',N'TANTRUNG2203',N'TANTRUNG2203'),
(N'MATK_KH05',N'KH05',N'DENNITRAN19',N'DENNITRAN19'),
(N'MATK_KH06',N'KH06',N'THAONGAN0705',N'THAONGAN0705'),
(N'MATK_KH07',N'KH07',N'DUYKHANH0309',N'DUYKHANH0309'),
(N'MATK_KH08',N'KH08',N'THANHCHUC1005',N'THANHCHUC1005'),
(N'MATK_KH09',N'KH09',N'BAOLINH1005',N'BAOLINH1005'),
(N'MATK_KH10',N'KH10',N'CONGMINH1010',N'CONGMINH1010'),
(N'MATK_KH11',N'KH11',N'HUYENTRAM0109',N'HUYENTRAM0109'),
(N'MATK_KH12',N'KH12',N'PHUONGQUYNH2508',N'PHUONGQUYNH2508');


CREATE TABLE HTTT( --HÌNH THỨC THANH TOÁN
    MATT NVARCHAR(10) NOT NULL PRIMARY KEY,
    TENTT NVARCHAR(100)
)
INSERT HTTT VALUES
(N'HTTT_TM',N'TIỀN MẶT'),
(N'HTTT_TS',N'THẺ SEC'),
(N'HTTT_CK',N'CHUYỂN KHOẢN'),
(N'HTTT_MM',N'MOMO'),
(N'HTTT_TGN',N'THẺ GHI NỢ');

CREATE TABLE TTSP ( --TÌNH TRẠNG SẢN PHẨM
    MATTSP NVARCHAR(10) NOT NULL PRIMARY KEY,
    TENTTSP NVARCHAR(50)
)
INSERT TTSP VALUES 
(N'NKD',N'NGỪNG KINH DOANH'),
(N'CNH',N'CHỜ NHẬP HÀNG'),
(N'DB',N'ĐANG BÁN'),
(N'HH',N'HẾT HÀNG');

CREATE TABLE NHACUNGCAP(
    MANCC NVARCHAR(10) NOT NULL PRIMARY KEY,
    TENNCC NVARCHAR(200)
)
INSERT NHACUNGCAP VALUES 
(N'NCC01',N'TRUNG TÂM SẢN XUẤT MÓC KHÓA'),
(N'NCC02',N'CÔNG TY MỐC KHÓC AN BÌNH'),
(N'NCC03',N'SẢN XUẤT MỐC KHÓA VYVY'),
(N'NCC04',N'TIỆM GIA CÔNG MỐC KHÓA'),
(N'NCC05',N'MỐC KHÓA AN PHÚ'),
(N'NCC06',N'MỐC KHÓA DIỆP ANH'),
(N'NCC07',N'GẤU BÔNG LÊ LỢI'),
(N'NCC08',N'TRUNG TÂM SẢN XUẤT GẤU BÔNG'),
(N'NCC09',N'CÔNG TY DỆT MAY GẤU BÔNG'),
(N'NCC10',N'CỬA HÀNG CÁ CHÉP'),
(N'NCC11',N'GẤU BÔNG CHUỒN CHUỒN'),
(N'NCC12',N'GẤU BÔNG VIPPRO');


CREATE TABLE HANG(
    MAHANG NVARCHAR(10) NOT NULL PRIMARY KEY,
    TENHANG NVARCHAR(100),
    MACL NVARCHAR(10) NOT NULL,
    MANCC NVARCHAR(10) NOT NULL,
    MATTSP NVARCHAR(10) NOT NULL,
    SOLUONG INT,
    DONGIANHAP FLOAT,
    DONGIABAN FLOAT,
    GHICHU NVARCHAR(MAX),
    CONSTRAINT FK_HANG_MACL
    FOREIGN KEY (MACL)
    REFERENCES CHATLIEU (MACL),
    CONSTRAINT FK_HANG_MANCC
    FOREIGN KEY (MANCC)
    REFERENCES NHACUNGCAP (MANCC),
    CONSTRAINT FK_HANG_MATTSP
    FOREIGN KEY (MATTSP)
    REFERENCES TTSP (MATTSP)
)
INSERT HANG VALUES 
(N'MH01',N'MÓC KHÓA PIKACHU',N'NH',N'NCC01',N'DB',1500,20000,35000,N''),
(N'MH02',N'MÓC KHÓA ẾCH KÌ DIỆU',N'TT',N'NCC03',N'DB',2000,25000,40000,N''),
(N'MH03',N'MÓC KHÓA KHỦNG LONG CON',N'TT',N'NCC02',N'DB',1700,25000,37000,N''),
(N'MH04',N'GẤU BÔNG DORAEMON',N'V',N'NCC09',N'DB',2100,50000,80000,N''),
(N'MH05',N'GẤU BÔNG POKEMON CON SÂU',N'V',N'NCC09',N'DB',2500,45000,70000,N''),
(N'MH06',N'GẤU BÔNG AMONG US',N'V',N'NCC09',N'DB',1600,70000,100000,N''),
(N'MH07',N'MÓC KHÓA LUFFY',N'NH',N'NCC01',N'DB',1200,27000,46000,N''),
(N'MH08',N'MÓC KHÓA MINION',N'V',N'NCC06',N'DB',1000,24000,38000,N''),
(N'MH09',N'GẤU BÔNG CHIẾN BINH ANH SÁNG',N'V',N'NCC12',N'DB',1500,70000,90000,N''),
(N'MH10',N'MÓC KHÓA JADIT',N'TT',N'NCC05',N'DB',1000,34000,59000,N''),
(N'MH11',N'MÓC KHÓA CHÚ TIỂU IKIU',N'B',N'NCC05',N'DB',2000,130000,200000,N''),
(N'MH12',N'GẤU BÔNG TRÁI DÂU',N'V',N'NCC07',N'DB',3350,80000,110000,N''),
(N'MH13',N'MÓC KHÓA ZORO',N'V',N'NCC01',N'CNH',0,27000,46000,N''),
(N'MH14',N'MÓC KHÓA NAMI',N'V',N'NCC01',N'CNH',0,27000,46000,N''),
(N'MH15',N'GẤU BÔNG NOBITA',N'V',N'NCC09',N'CNH',5,50000,80000,N''),
(N'MH16',N'MÓC KHÓA PHI HÀNH GIA',N'NH',N'NCC06',N'CNH',6,10000,15000,N''),
(N'MH17',N'MÓC KHÓA GẤU DỄ THƯƠNG',N'NH',N'NCC05',N'HH',0,10000,15000,N''),
(N'MH18',N'GẤU BÔNG HELLO KITTY',N'V',N'NCC08',N'HH',0,50000,80000,N''),
(N'MH19',N'MÓC KHÓA NHỰA',N'NH',N'NCC05',N'HH',0,10000,15000,N''),
(N'MH20',N'MÓC KHÓA SÚNG M24',N'B',N'NCC05',N'HH',0,25000,30000,N''),
(N'MH21',N'GẤU BÔNG DDORREAMON NHỎ',N'V',N'NCC09',N'NKD',5,30000,50000,N''),
(N'MH22',N'GẤU BÔNG PIKACHU NHỎ',N'V',N'NCC09',N'NKD',5,30000,50000,N''),
(N'MH23',N'MÓC KHÓA VỊT CON',N'NH',N'NCC06',N'NKD',4,10000,15000,N''),
(N'MH24',N'MÓC KHÓA HEO DỄ THƯƠNG',N'NH',N'NCC05',N'NKD',0,10000,15000,N'');


CREATE TABLE HOADONBAN (
    MAHD NVARCHAR(10) NOT NULL PRIMARY KEY,
    MANV NVARCHAR(10) NOT NULL,
    MAKH NVARCHAR(10) NOT NULL,
    NGAYBAN DATETIME,
    TONGTIEN FLOAT,
    MATT NVARCHAR(10) NOT NULL,
    CONSTRAINT FK_HOADONBAN_MANV
    FOREIGN KEY (MANV)
    REFERENCES NHANVIEN (MANV),
    CONSTRAINT FK_HOADONBAN_MAKH
    FOREIGN KEY (MAKH)
    REFERENCES KHACHHANG (MAKH),
    CONSTRAINT FK_HOADONBAN_MATT
    FOREIGN KEY (MATT)
    REFERENCES HTTT (MATT)
)
INSERT HOADONBAN VALUES  
(N'HD01',N'NV01',N'KH01',N'2021-09-22',1085000,N'HTTT_TM'), --MH01: 31
(N'HD02',N'NV01',N'KH02',N'2021-09-23',2560000,N'HTTT_CK'), --MH02: 10 , MH05: 10, MH06: 10, MK07: 10
(N'HD03',N'NV02',N'KH03',N'2021-09-24',3900000,N'HTTT_TM'), --MH04:15, MH05: 15, MH12: 15
(N'HD04',N'NV02',N'KH04',N'2021-09-25',3900000,N'HTTT_CK'),--MH09:20, MH07:20, MH10:20
(N'HD05',N'NV03',N'KH05',N'2021-09-26',2875000,N'HTTT_TM'),--MH08: 25, MH02: 25, MH03:25
(N'HD06',N'NV03',N'KH06',N'2021-09-27',7200000,N'HTTT_MM'),--MH09: 80
(N'HD07',N'NV04',N'KH07',N'2022-01-22',4000000,N'HTTT_MM'), --MH04: 50
(N'HD08',N'NV04',N'KH08',N'2022-01-22',1900000,N'HTTT_TS'), --MH08: 50
(N'HD09',N'NV05',N'KH09',N'2022-01-22',18000000,N'HTTT_TM'), --MH11: 90
(N'HD10',N'NV05',N'KH10',N'2022-01-22',2330000,N'HTTT_TM'), --MH7:10 MH8: 10 MH9:10 MH11:10
(N'HD11',N'NV06',N'KH11',N'2022-01-22',5400000,N'HTTT_MM'), --MH4: 30 MH6: 30
(N'HD12',N'NV06',N'KH12',N'2022-01-22',2100000,N'HTTT_MM'), --MH5: 30
(N'HD13',N'NV04',N'KH09',N'2022-01-22',2700000,N'HTTT_TGN'), --MH9: 30
(N'HD14',N'NV02',N'KH02',N'2022-01-22',16900000,N'HTTT_TS'); --MH10: 100 MH12:100

INSERT HOADONBAN VALUES 
(N'HD15',N'NV03',N'KH03',N'2022-01-03',895000,N'HTTT_TM'), --MH01, SOLUONG: 15, DONGIA: 35000 --MH03, SOLUONG: 10, DONGIA:37000
(N'HD16',N'NV02',N'KH04',N'2022-01-15',1770000,N'HTTT_TM'),--MH02, SOLUONG: 30, DONGIA: 40000 --MH08, SOLUONG: 15, DONGIA:38000
(N'HD17',N'NV03',N'KH06',N'2022-01-26',2750000,N'HTTT_CK'),--MH05, SOLUONG: 20, DONGIA: 70000 --MH09, SOLUONG: 15, DONGIA:90000
(N'HD18',N'NV04',N'KH07',N'2022-02-10',1825000,N'HTTT_TGN'),--MH01, SOLUONG: 10, DONGIA: 35000 --MH010, SOLUONG: 25, DONGIA:59000
(N'HD19',N'NV04',N'KH08',N'2022-02-18',3555000,N'HTTT_MM'),--MH011, SOLUONG: 15, DONGIA: 200000 --MH03, SOLUONG: 15, DONGIA:37000
(N'HD20',N'NV05',N'KH09',N'2022-01-28',4750000,N'HTTT_CK'),--MH06, SOLUONG: 20, DONGIA: 100000 --MH12, SOLUONG: 25, DONGIA:110000
(N'HD21',N'NV06',N'KH11',N'2022-03-08',1790000,N'HTTT_TM'),--MH04, SOLUONG: 15, DONGIA: 80000 --MH10, SOLUONG: 10, DONGIA:59000
(N'HD22',N'NV06',N'KH12',N'2022-03-21',2420000,N'HTTT_MM'),--MH07, SOLUONG: 20, DONGIA: 46000 --MH06, SOLUONG: 15, DONGIA:100000
(N'HD23',N'NV01',N'KH01',N'2022-04-08',3050000,N'HTTT_TS'),--MH05, SOLUONG: 15, DONGIA: 70000 --MH11, SOLUONG: 10, DONGIA:200000
(N'HD24',N'NV01',N'KH02',N'2022-04-19',1535000,N'HTTT_MM'),--MH01, SOLUONG: 10, DONGIA: 35000 --MH03, SOLUONG: 5, DONGIA:370000--MH06,SOLUONG: 10, DONGIA: 100000
(N'HD25',N'NV02',N'KH12',N'2022-04-30',2480000,N'HTTT_TS');--MH06, SOLUONG: 10, DONGIA: 100000 --MH12, SOLUONG: 10, DONGIA:110000--MH08, SOLUONG: 10, DONGIA: 38000

INSERT HOADONBAN VALUES 
(N'HD26',N'NV02',N'KH04',N'2022-08-16',2000000,N'HTTT_TGN'),	--mã hàng: MH11;số lượng: 10
(N'HD27',N'NV04',N'KH08',N'2022-09-19',1360000,N'HTTT_TM'),	--mã hàng: MH02 ;số lượng: 34
(N'HD28',N'NV05',N'KH09',N'2022-08-22',1100000,N'HTTT_CK'),	--mã hàng: MH06;số lượng: 11
(N'HD29',N'NV05',N'KH12',N'2022-07-22',1540000,N'HTTT_MM'),	--mã hàng: MH05 ;số lượng: 22
(N'HD30',N'NV06',N'KH11',N'2022-06-11',315000,N'HTTT_CK'),	--mã hàng: MH01 ;số lượng: 9
(N'HD31',N'NV06',N'KH12',N'2022-06-27',1560000,N'HTTT_TM'),	--mã hàng: MH02 ,MH05 ,MH07 ;số lượng: 10,10,10
(N'HD32',N'NV04',N'KH08',N'2022-06-12',8320000,N'HTTT_CK'),	--mã hàng: MH02 ,MH05 ,MH06 ;số lượng: 9,78,25
(N'HD33',N'NV04',N'KH08',N'2022-07-29',223000,N'HTTT_TM'),	--mã hàng: MH08 ,MH01 ,MH02 ;số lượng: 1,3,2
(N'HD34',N'NV01',N'KH01',N'2022-09-12',246000,N'HTTT_MM'),	--mã hàng: MH07 ,MH09,MH12;số lượng: 1,1,1
(N'HD35',N'NV02',N'KH04',N'2022-09-22',206000,N'HTTT_TM'),	--mã hàng: MH05 ,MH07,MH09 ;số lượng: 1,1,1
(N'HD36',N'NV03',N'KH04',N'2022-08-08',295000,N'HTTT_MM'),	--mã hàng: MH06,MH04 ,MH01 ;số lượng: 1,2,1
(N'HD37',N'NV03',N'KH09',N'2022-07-03',310000,N'HTTT_CK'),	--mã hàng: MH11,MH12 ;số lượng: 1,1
(N'HD38',N'NV04',N'KH09',N'2022-09-04',470000,N'HTTT_TM'),	--mã hàng: MH05 ,MH11 ;số lượng: 1,2
(N'HD39',N'NV04',N'KH09',N'2022-06-21',247000,N'HTTT_CK'),	--mã hàng: MH03 ,MH05 ;số lượng: 1,3
(N'HD40',N'NV05',N'KH09',N'2022-09-23',280000,N'HTTT_TGN'),   --mã hàng: MH04 ,MH06 ;số lượng: 1,2
(N'HD41',N'NV05',N'KH09',N'2022-08-11',110000,N'HTTT_MM'),   --mã hàng: MH02 ,MH05 ;số lượng: 1,1
(N'HD42',N'NV06',N'KH09',N'2022-06-22',425000,N'HTTT_TM'),   --mã hàng: MH01 ,MH05 ,MH02 ;số lượng: 3,4,1
(N'HD43',N'NV06',N'KH11',N'2022-05-30',518000,N'HTTT_CK');   --mã hàng: MH10 ,MH04 ;số lượng:2,5

CREATE TABLE CTHDB (--CHI TIẾT HÓA ĐƠN BÁN
    MAHDCT NVARCHAR(10) NOT NULL PRIMARY KEY,
    MAHD NVARCHAR(10) NOT NULL,
    MAHANG NVARCHAR(10) NOT NULL,
    SOLUONG FLOAT,
    DONGIA FLOAT, --ĐƠN GIÁ BÁN
    GIAMGIA FLOAT,
    THANHTIEN FLOAT,
    CONSTRAINT FK_CTHDB_MAHD
    FOREIGN KEY (MAHD)
    REFERENCES HOADONBAN (MAHD),
    CONSTRAINT FK_CTHDB_MAHANG
    FOREIGN KEY (MAHANG)
    REFERENCES HANG (MAHANG)
)
INSERT CTHDB VALUES
(N'MAHDCT_001',N'HD01',N'MH01',31,35000,0,1085000),
(N'MAHDCT_002',N'HD02',N'MH02',10,40000,0,400000),
(N'MAHDCT_003',N'HD02',N'MH05',10,70000,0,700000),
(N'MAHDCT_004',N'HD02',N'MH06',10,100000,0,1000000),
(N'MAHDCT_005',N'HD02',N'MH07',10,46000,0,460000),
(N'MAHDCT_006',N'HD03',N'MH04',15,80000,0,1200000),
(N'MAHDCT_007',N'HD03',N'MH05',15,70000,0,1050000),
(N'MAHDCT_008',N'HD03',N'MH12',15,110000,0,1650000),
(N'MAHDCT_009',N'HD04',N'MH09',20,90000,0,1800000),
(N'MAHDCT_010',N'HD04',N'MH07',20,46000,0,920000),
(N'MAHDCT_011',N'HD04',N'MH10',20,59000,0,1180000),
(N'MAHDCT_012',N'HD05',N'MH08',25,38000,0,760000),
(N'MAHDCT_013',N'HD05',N'MH02',25,40000,0,1000000),
(N'MAHDCT_014',N'HD05',N'MH03',25,37000,0,925000),
(N'MAHDCT_015',N'HD06',N'MH09',80,90000,0,7200000),
(N'MAHDCT_016',N'HD07',N'MH04',50,80000,0,4000000),
(N'MAHDCT_017',N'HD08',N'MH08',50,38000,0,1900000),
(N'MAHDCT_018',N'HD09',N'MH11',90,200000,0,18000000),
(N'MAHDCT_019',N'HD10',N'MH07',10,46000,0,460000),
(N'MAHDCT_020',N'HD10',N'MH08',10,38000,0,380000),
(N'MAHDCT_021',N'HD10',N'MH09',10,90000,0,900000),
(N'MAHDCT_022',N'HD10',N'MH11',10,200000,0,2000000),
(N'MAHDCT_023',N'HD11',N'MH04',30,80000,0,2400000),
(N'MAHDCT_024',N'HD11',N'MH06',30,100000,0,3000000),
(N'MAHDCT_025',N'HD12',N'MH05',30,70000,0,2100000),
(N'MAHDCT_026',N'HD13',N'MH09',30,90000,0,2700000),
(N'MAHDCT_027',N'HD14',N'MH10',100,59000,0,5900000),
(N'MAHDCT_028',N'HD14',N'MH12',100,110000,0,11000000),

(N'MAHDCT_029',N'HD15',N'MH02',15,35000,0,525000),
(N'MAHDCT_030',N'HD15',N'MH03',10,37000,0,370000),
(N'MAHDCT_031',N'HD16',N'MH02',30,40000,0,1200000),
(N'MAHDCT_032',N'HD16',N'MH08',15,38000,0,570000),
(N'MAHDCT_033',N'HD17',N'MH05',20,70000,0,1400000),
(N'MAHDCT_034',N'HD17',N'MH09',15,90000,0,1350000),
(N'MAHDCT_035',N'HD18',N'MH01',10,35000,0,350000),
(N'MAHDCT_036',N'HD18',N'MH10',25,59000,0,1475000),
(N'MAHDCT_037',N'HD19',N'MH11',15,200000,0,3000000),
(N'MAHDCT_038',N'HD19',N'MH03',15,37000,0,555000),
(N'MAHDCT_039',N'HD20',N'MH06',20,100000,0,2000000),
(N'MAHDCT_040',N'HD20',N'MH12',25,110000,0,2750000),
(N'MAHDCT_041',N'HD21',N'MH04',15,80000,0,1200000),
(N'MAHDCT_042',N'HD21',N'MH10',10,59000,0,590000),
(N'MAHDCT_043',N'HD22',N'MH07',20,46000,0,920000),
(N'MAHDCT_044',N'HD22',N'MH06',15,100000,0,1500000),
(N'MAHDCT_045',N'HD23',N'MH05',15,70000,0,1050000),
(N'MAHDCT_046',N'HD23',N'MH11',10,200000,0,2000000),
(N'MAHDCT_047',N'HD24',N'MH01',10,35000,0,350000),
(N'MAHDCT_048',N'HD24',N'MH03',5,37000,0,185000),
(N'MAHDCT_049',N'HD24',N'MH06',10,100000,0,1000000),
(N'MAHDCT_050',N'HD25',N'MH06',10,100000,0,1000000),
(N'MAHDCT_051',N'HD25',N'MH12',10,110000,0,1100000),
(N'MAHDCT_052',N'HD25',N'MH08',10,38000,0,380000),

(N'MAHDCT_053',N'HD26',N'MH11',10,200000,0,2000000),
(N'MAHDCT_054',N'HD27',N'MH02',34,40000,0,1360000),
(N'MAHDCT_055',N'HD28',N'MH06',11,100000,0,1100000),
(N'MAHDCT_056',N'HD29',N'MH05',22,70000,0,1540000),
(N'MAHDCT_057',N'HD30',N'MH01',9,35000,0,315000),
(N'MAHDCT_058',N'HD31',N'MH02',10,40000,0,400000),
(N'MAHDCT_059',N'HD31',N'MH05',10,70000,0,700000),
(N'MAHDCT_060',N'HD31',N'MH07',10,46000,0,460000),
(N'MAHDCT_061',N'HD32',N'MH02',9,40000,0,360000),
(N'MAHDCT_062',N'HD32',N'MH05',78,70000,0,5460000),
(N'MAHDCT_063',N'HD32',N'MH06',25,100000,0,2500000),
(N'MAHDCT_064',N'HD33',N'MH08',1,38000,0,38000),
(N'MAHDCT_065',N'HD33',N'MH01',3,35000,0,105000),
(N'MAHDCT_066',N'HD33',N'MH02',2,40000,0,80000),
(N'MAHDCT_067',N'HD34',N'MH07',1,46000,0,46000),
(N'MAHDCT_068',N'HD34',N'MH09',1,90000,0,90000),
(N'MAHDCT_069',N'HD34',N'MH12',1,110000,0,110000),
(N'MAHDCT_070',N'HD35',N'MH05',1,70000,0,70000),
(N'MAHDCT_071',N'HD35',N'MH07',1,46000,0,46000),
(N'MAHDCT_072',N'HD35',N'MH09',1,90000,0,90000),
(N'MAHDCT_073',N'HD36',N'MH06',1,100000,0,100000),
(N'MAHDCT_074',N'HD36',N'MH04',2,80000,0,160000),
(N'MAHDCT_075',N'HD36',N'MH01',1,35000,0,35000),
(N'MAHDCT_076',N'HD37',N'MH11',1,200000,0,200000),
(N'MAHDCT_077',N'HD37',N'MH12',1,110000,0,110000),
(N'MAHDCT_078',N'HD38',N'MH05',1,70000,0,70000),
(N'MAHDCT_079',N'HD38',N'MH11',2,200000,0,400000),

(N'MAHDCT_080',N'HD39',N'MH03',1,37000,0,37000),
(N'MAHDCT_081',N'HD39',N'MH05',3,70000,0,210000),
(N'MAHDCT_082',N'HD40',N'MH04',1,80000,0,80000),
(N'MAHDCT_083',N'HD40',N'MH06',1,100000,0,100000),
(N'MAHDCT_084',N'HD41',N'MH02',1,40000,0,40000),
(N'MAHDCT_085',N'HD41',N'MH05',1,70000,0,70000),
(N'MAHDCT_086',N'HD42',N'MH01',3,35000,0,105000),
(N'MAHDCT_087',N'HD42',N'MH05',4,70000,0,280000),
(N'MAHDCT_088',N'HD42',N'MH02',1,40000,0,40000),
(N'MAHDCT_089',N'HD43',N'MH10',2,59000,0,118000),
(N'MAHDCT_090',N'HD43',N'MH04',5,80000,0,400000);

CREATE TABLE LICHSUDONGIA ( --LỊCH SỮ ĐƠN GIÁ
    MALS NVARCHAR(10) NOT NULL PRIMARY KEY,
    MAHANG NVARCHAR(10) NOT NULL,
	DONGIANHAPCU FLOAT,
	DONGIANHAPMOI FLOAT,
	DONGIABANCU FLOAT,
	DONGIABANMOI FLOAT,
	NGAYCAPNHAT DATE,
	CONSTRAINT FK_LICHSU_MAHANG
	FOREIGN KEY (MAHANG)
	REFERENCES dbo.HANG(MAHANG)
)
INSERT LICHSUDONGIA VALUES 
(N'MALS01',N'MH01',20000,20000,35000,35000,'2021-05-07'),
(N'MALS02',N'MH02',25000,25000,40000,40000,'2021-05-07'),
(N'MALS03',N'MH03',25000,25000,37000,37000,'2021-05-07'),
(N'MALS04',N'MH04',50000,50000,80000,80000,'2021-05-07'),
(N'MALS05',N'MH05',45000,45000,70000,70000,'2021-05-30'),
(N'MALS06',N'MH06',70000,70000,100000,100000,'2021-05-30'),
(N'MALS07',N'MH07',27000,27000,46000,46000,'2021-05-15'),
(N'MALS08',N'MH08',24000,24000,38000,38000,'2021-06-30'),
(N'MALS09',N'MH09',70000,70000,90000,90000,'2021-06-30'),
(N'MALS10',N'MH10',34000,34000,59000,59000,'2021-06-30'),
(N'MALS11',N'MH11',130000,130000,200000,200000,'2020-07-15'),
(N'MALS12',N'MH12',80000,80000,100000,110000,'2020-07-15');

CREATE TABLE LICHSUNHAPHANG (
    MALSNH NVARCHAR(10) NOT NULL PRIMARY KEY,
    MAHANG NVARCHAR(10) NOT NULL,
    TONKHO INT,
    SOLUONGNHAP INT,
    TONGKHO INT,
    THOIGIAN DATE,
    CONSTRAINT FK_LICHSUNHAPHANG_MAHANG
	FOREIGN KEY (MAHANG)
	REFERENCES dbo.HANG(MAHANG)
)
INSERT LICHSUNHAPHANG VALUES
(N'MA_LSNH01',N'MH01',0,1500,1500,N'2021-05-07'),
(N'MA_LSNH02',N'MH02',0,2000,2000,N'2021-05-07'),
(N'MA_LSNH03',N'MH03',0,1700,1700,N'2021-05-07'),
(N'MA_LSNH04',N'MH04',0,2100,2100,N'2021-05-07'),
(N'MA_LSNH05',N'MH05',0,2500,2500,N'2021-05-30'),
(N'MA_LSNH06',N'MH06',0,1600,1600,N'2021-05-30'),
(N'MA_LSNH07',N'MH07',0,1200,1200,N'2021-05-15'),
(N'MA_LSNH08',N'MH08',0,1000,1000,N'2021-06-30'),
(N'MA_LSNH09',N'MH09',0,1500,1500,N'2021-06-30'),
(N'MA_LSNH10',N'MH10',0,1000,1000,N'2021-06-30'),
(N'MA_LSNH11',N'MH11',0,2000,2000,N'2020-07-15'),
(N'MA_LSNH12',N'MH12',0,3350,3350,N'2020-07-15');


--TRUY VẤN
SELECT SUM(TONGTIEN)  AS KH01 FROM HOADONBAN WHERE MAKH = N'KH01'
SELECT SUM(TONGTIEN)  AS KH02 FROM HOADONBAN WHERE MAKH = N'KH02'
SELECT SUM(TONGTIEN)  AS KH03 FROM HOADONBAN WHERE MAKH = N'KH03'
SELECT SUM(TONGTIEN)  AS KH04 FROM HOADONBAN WHERE MAKH = N'KH04'
SELECT SUM(TONGTIEN)  AS KH05 FROM HOADONBAN WHERE MAKH = N'KH05'
SELECT SUM(TONGTIEN)  AS KH06 FROM HOADONBAN WHERE MAKH = N'KH06'
SELECT SUM(TONGTIEN)  AS KH07 FROM HOADONBAN WHERE MAKH = N'KH07'
SELECT SUM(TONGTIEN)  AS KH08 FROM HOADONBAN WHERE MAKH = N'KH08'
SELECT SUM(TONGTIEN)  AS KH09 FROM HOADONBAN WHERE MAKH = N'KH09'
SELECT SUM(TONGTIEN)  AS KH10 FROM HOADONBAN WHERE MAKH = N'KH10'
SELECT SUM(TONGTIEN)  AS KH11 FROM HOADONBAN WHERE MAKH = N'KH11'
SELECT SUM(TONGTIEN)  AS KH12 FROM HOADONBAN WHERE MAKH = N'KH12'

--Các câu truy vấn
--1 BẢNG CHI TIẾT NHÀ CUNG CẤP 
SELECT N.MANCC,N.TENNCC,H.MAHANG, H.TENHANG
FROM dbo.HANG AS H INNER JOIN dbo.NHACUNGCAP AS N
ON H.MANCC=N.MANCC

SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2021' AND MONTH(NGAYBAN) = '09'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2021' AND MONTH(NGAYBAN) = '10'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2021' AND MONTH(NGAYBAN) = '11'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2021' AND MONTH(NGAYBAN) = '12'

SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '01'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '02'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '03'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '04'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '05'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '06'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '07'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '08'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '09'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '10'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '11'
SELECT SUM(TONGTIEN)  FROM HOADONBAN WHERE YEAR(NGAYBAN) = '2022' AND MONTH(NGAYBAN) = '12'

--Trigger nhân viên
